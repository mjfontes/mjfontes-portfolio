"use strict";(self.webpackChunkwcf_addons=self.webpackChunkwcf_addons||[]).push([[122],{2127:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}});var s=a(1609),r=a(6792);const n=({size:e=24,className:t,...a})=>(0,s.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,...a,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:(0,r.cn)("animate-spin",t)},(0,s.createElement)("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}));var o=a(2133),l=a(2579),c=a(4848),i="Progress",[m,p]=(0,o.A)(i),[d,u]=m(i),h=s.forwardRef((e,t)=>{const{__scopeProgress:a,value:s=null,max:r,getValueLabel:n=w,...o}=e;!r&&0!==r||_(r)||console.error(`Invalid prop \`max\` of value \`${r}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`);const i=_(r)?r:100;null===s||N(s,i)||console.error(`Invalid prop \`value\` of value \`${`${s}`}\` supplied to \`Progress\`. The \`value\` prop must be:\n  - a positive number\n  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)\n  - \`null\` or \`undefined\` if the progress is indeterminate.\n\nDefaulting to \`null\`.`);const m=N(s,i)?s:null,p=x(m)?n(m,i):void 0;return(0,c.jsx)(d,{scope:a,value:m,max:i,children:(0,c.jsx)(l.sG.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":x(m)?m:void 0,"aria-valuetext":p,role:"progressbar","data-state":v(m,i),"data-value":m??void 0,"data-max":i,...o,ref:t})})});h.displayName=i;var g="ProgressIndicator",f=s.forwardRef((e,t)=>{const{__scopeProgress:a,...s}=e,r=u(g,a);return(0,c.jsx)(l.sG.div,{"data-state":v(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...s,ref:t})});function w(e,t){return`${Math.round(e/t*100)}%`}function v(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function x(e){return"number"==typeof e}function _(e){return x(e)&&!isNaN(e)&&e>0}function N(e,t){return x(e)&&!isNaN(e)&&e<=t&&e>=0}f.displayName=g;var b=h,y=f;const P=s.forwardRef(({className:e,value:t,...a},n)=>(0,s.createElement)(b,{ref:n,className:(0,r.cn)("relative h-2 w-full overflow-hidden rounded-full bg-background-secondary",e),...a},(0,s.createElement)(y,{className:"h-full w-full flex-1 bg-[linear-gradient(90deg,#00D202_0%,#23C6CF_100%)] transition-all",style:{transform:`translateX(-${100-(0===t?-1:t||-1)}%)`}})));P.displayName=b.displayName;var E=a.p+"images/demo-importing-bg.b2796b8f.png",S=a(9179),D=()=>{const[e,t]=(0,s.useState)(!1),[a,o]=(0,s.useState)(""),[l,c]=(0,s.useState)(""),[i,m]=(0,s.useState)(null),[p,d]=(0,s.useState)(0),{setTabKey:u}=(0,S.OL)(),h=new URL(window.location.href),g=h.searchParams.get("template"),f=h.searchParams.get("templateid"),w=h.searchParams.get("plugins"),v=h.searchParams.get("theme"),x=h.searchParams.get("attachment"),_=(e,t)=>{const a=h.searchParams.get("page");h.search="",h.hash="",h.search=`page=${a}`,h.searchParams.set("template",g),h.searchParams.set("templateid",f),h.searchParams.set("tab",e),t.plugins&&h.searchParams.set("plugins",t.plugins),t.theme&&h.searchParams.set("theme",t.theme),h.searchParams.set("attachment",t.attachment),window.history.replaceState({},"",h),u(e)},[N,b]=(0,s.useState)("Varifying"),[y,D]=(0,s.useState)();(0,s.useEffect)(()=>{if(e){I(e);const t=setInterval(()=>{k()},5e3);return()=>clearInterval(t)}C(f)},[e]);const C=(0,s.useCallback)((0,r.eD)(async e=>{try{const a=new URL(`${WCF_ADDONS_ADMIN?.st_template_domain}wp-json/wp/v2/starter-templates`);e&&a.searchParams.append("tplid",e),await fetch(a.toString()).then(e=>e.json()).then(a=>{if(a?.templates){const s=Object.entries(a.templates).find(([t,a])=>a.id==e)?.[1];t(s)}})}catch(e){console.log(e)}}),[]),k=async()=>{const e=new URL(window.location.href).searchParams.get("tab");if(e&&"complete-import"==e)return;const t=new URLSearchParams;t.append("action","aaeaddon_heartbeat_data"),t.append("nonce",WCF_ADDONS_ADMIN.nonce);const a=await fetch(WCF_ADDONS_ADMIN.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t.toString()});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const s=a.headers.get("content-type");if(s&&s.includes("application/json")){const e=await a.json();if("single"===e?.import_porgress?.type){const t=e.import_porgress.progress||0,a=e.import_porgress.total_items||1,s=Math.min(Math.round(t/a*100),100),r=Math.floor(5*Math.random())+40,n=t/a*50,l=Math.min(Math.round(r+n),100);c(e.import_porgress?.title),d(e=>Math.max(e,l)),o(`ðŸ“¦ Content Import: ${s}% (${t} of ${a})\n`),l>=100&&(shouldStop=!0,clearInterval(intervalId))}}},I=(0,s.useCallback)((0,r.eD)(async e=>{try{delete e.author,delete e.categories,delete e.date,delete e.demo_link,delete e.user_favourite,delete e.template_preview,delete e.downloads,delete e.is_pro,delete e.excerpt,m(e);const t=new URLSearchParams;e?.next_step&&"download-xml-file"==e.next_step?t.append("action","aaeaddon_upload_manual_import_file"):t.append("action","aaeaddon_template_installer"),t.append("template_data",JSON.stringify(e)),t.append("nonce",WCF_ADDONS_ADMIN.nonce),w&&t.append("user_plugins",w),v&&t.append("theme_slug",v),t.append("attachment",x);const a=await fetch(WCF_ADDONS_ADMIN.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t.toString()});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const s=a.headers.get("content-type");if(s&&s.includes("application/json")){const t=await a.json();void 0!==t.status&&"newAJAX"===t.status&&(t?.state&&""!==t.state&&o(t.state),I(e)),t?.progress&&d(e=>Number(t.progress)>Number(e)?t.progress:e),t?.template&&(!0==("done"===t.template.next_step?.trim().toLowerCase())?(e=>{const t=h.searchParams.get("page");h.search="",h.hash="",h.search=`page=${t}`,h.searchParams.set("tab",e),window.history.replaceState({},"",h),u(e)})("complete-import"):"fail"===t.template.next_step?_("fail-import",{plugins:w,theme:v,attachment:x}):(I(t.template),t?.template?.next_step&&b(t.template.next_step),t?.msg&&o(t.msg)))}else I(e)}catch(e){console.error("Fetch failed:",e.message),o(e.message),i?I(i):_("fail-import",{plugins:w,theme:v,attachment:x,msg:e.message})}},300),[]);return(0,s.createElement)("div",{className:"bg-background w-[680px] rounded-2xl p-1.5 shadow-auth-card"},(0,s.createElement)("div",{className:"border border-border-secondary rounded-xl p-8"},(0,s.createElement)("div",{className:"mb-6"},(0,s.createElement)("h3",{className:"text-2xl font-medium"},e?"Creating your website...":"Template finding....."," "),(0,s.createElement)("p",{className:"mt-1.5 text-text-secondary"},"Please wait, your website is being created. It will take few minute. Do not reload."),(0,s.createElement)("p",{className:"total-State mt-1.5 text-text-secondary"},y)),(0,s.createElement)("div",{className:"mb-8"},(0,s.createElement)("img",{src:E,className:"w-[616px] h-[258px]",alt:"demo importing"})),(0,s.createElement)("div",null,(0,s.createElement)("h4",{className:"text-xl font-medium mb-2"},l),(0,s.createElement)("p",{className:"text-text-secondary"},(0,s.createElement)("span",{className:"text-text"})," ",a),(0,s.createElement)("div",{className:"mt-4"},(0,s.createElement)("span",null,(0,s.createElement)(P,{value:p}))),(0,s.createElement)("div",{className:"flex items-center gap-1.5 mt-3"},(0,s.createElement)(n,{className:"text-[#07B22B]"})," ",(0,s.createElement)("p",{className:"text-sm"},(0,s.createElement)("span",null,p,"%")," Completed")))))}}}]);